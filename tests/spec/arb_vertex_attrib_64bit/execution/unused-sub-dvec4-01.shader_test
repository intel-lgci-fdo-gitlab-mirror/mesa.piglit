[require]
GLSL >= 1.50
GL_ARB_gpu_shader_fp64
GL_ARB_vertex_attrib_64bit
GL_ARB_explicit_attrib_location

[vertex shader]
#version 150
#extension GL_ARB_gpu_shader_fp64 : require
#extension GL_ARB_vertex_attrib_64bit : require
#extension GL_ARB_explicit_attrib_location : require

layout(location = 0) in dvec4 position;
layout(location = 1) in dvec4 color0;
layout(location = 2) in dvec4 color1;
layout(location = 3) in dvec4 color2;

flat out dvec4 fscolor0;
flat out dvec4 fscolor1;
flat out dvec4 fscolor2;

void main()
{
    gl_Position = vec4(position);
    fscolor0 = color0;
    fscolor1 = color1;
    fscolor2 = color2;
}

[fragment shader]
#version 150
#extension GL_ARB_gpu_shader_fp64 : require

flat in dvec4 fscolor0;
flat in dvec4 fscolor1;
flat in dvec4 fscolor2;

out vec4 color;

void main()
{
    // NOTE: fscolor1.zw is unused
    color = vec4((fscolor0 + fscolor1.xyyx + fscolor2) / 3.0);
}

[vertex data]
position/double/4   color0/double/4  color1/double/4  color2/double/4
-1.0 -1.0 0.0 1.0   0.0 1.0 0.0 1.0  1.0 0.0 0.0 1.0  0.0 0.0 1.0 1.0
 1.0 -1.0 0.0 1.0   0.0 1.0 0.0 1.0  1.0 0.0 0.0 1.0  0.0 0.0 1.0 1.0
 1.0  1.0 0.0 1.0   0.0 1.0 0.0 1.0  1.0 0.0 0.0 1.0  0.0 0.0 1.0 1.0
-1.0  1.0 0.0 1.0   0.0 1.0 0.0 1.0  1.0 0.0 0.0 1.0  0.0 0.0 1.0 1.0

[test]
clear color 0.0 0.0 1.0 0.0
clear
draw arrays GL_TRIANGLE_FAN 0 4
probe rgba 0 0 0.333333 0.333333 0.333333 1.0
